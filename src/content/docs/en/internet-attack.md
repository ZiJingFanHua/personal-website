---
title: "常见网络攻击"
description: "常见网络攻击"
date: 2022-06-05
---

## xss

### 什么是XSS攻击

cross-site scripting(跨站脚本攻击)，简称XSS，是一种代码注入攻击。攻击者通过在目标网站上注入恶意脚本，使之在用户的浏览器上运行。利用这些恶意脚本，攻击者可获取用户的敏感信息如Cookie、SessionID等，进而危害数据安全。

xss攻击的的本质就是网站没有对恶意代码进行过滤，但恶意代码与正常代码混合在一起时，浏览器没办法分辨那些是恶意代码，从而执行了恶意代码

### 常见的XSS攻击类型

- 存储型：攻击者的恶意代码会被上传到服务器，保存在数据库中，例如留言，评论等公共区域，当其他用户访问存储有恶意代码的页面就会自动执行恶意代码
- 反射型：攻击者通过特定方式来诱惑受害者去访问一个包含恶意代码的url，当受害者点击恶意链接url的时候，恶意代码会直接在受害者的主机的浏览器上执行。
- DOM型：服务器端经常使用列如document.boby.innerHtml等函数动态生成html页面，如果这些函数在引用某些变量时没有进行过滤或检查，就会产生DOM型的XSS

#### 攻击步骤

存储型:

1. 攻击者将恶意代码提交至服务器
2. 用户打开目标网站，服务端将恶意代码从数据库中取出拼接在html中返回给浏览器
3. 用户浏览器收到响应后解析执行，恶意代码也在这时被执行
4. 恶意代码窃取用户的信息发到攻击者网站或者冒充用户做攻击者的目标行为

反射型:

1. 攻击者构造特殊的URL其中就包涵了恶意代码
2. ⽤户打开带有恶意代码的 URL 时，⽹站服务器将恶意代码从 URL 中取出，拼接在 HTML 中返回给浏览器
3. 用户浏览器收到响应后解析执行，恶意代码也在这时被执行
4. 恶意代码窃取用户的信息发到攻击者网站或者冒充用户做攻击者的目标行为

DOM型:

1. 攻击者构造特殊的URL其中就包涵了恶意代码
2. 用户打开带有恶意代码的 URL
3. JavaScript 取出 URL 中的恶意代码并执⾏浏览器得到响应后解析执行
4. 恶意代码窃取用户的信息发到攻击者网站或者冒充用户做攻击者的目标行为

注意：

存储型和反射型利用了后端漏洞，DOM型利用了前端漏洞，但本质都是因为浏览器无法识别恶意代码才会出现的问题

### 防御XSS攻击

1. 转义HTML, 如果不得不拼接 HTML，得对需要插入到 HTML 中的代码做好充分的转义
2. 在cookie中设置HttpOnly属性，js脚本将无法读取到cookie信息
3. 使用 CSP ,其本质是建立一个白名单，告诉浏览器哪些外部资源可以加载和执行，从而防止恶意代码的注入攻击

## CSRF

### 什么是CSRF攻击

CSRF(Cross Site Request Forgery)，即跨站请求伪造攻击，攻击者诱导用户进入一个第三方的网站，该网站就可以向被攻击网站发送跨站请求，如果用户在被攻击网站还保留了登录状态，那么攻击者就可以利用这个状态，冒充用户向服务器发出操作

### 如何防御CSRF攻击

1. 进行同源检测，服务器根据 http 请求头中 origin 或者 referer 信息来判断请求是否为允许访问的站点。当 origin 或者 referer 信息都不存在的时候，直接阻止请求。这种方式的缺点是有些情况下 referer 可以被伪造，同时还会把搜索引擎的链接也给屏蔽
2. 使用TOKEN 进行验证
3. 使用Cookie 进行双重验证，服务器在用户访问网站页面时，向请求域名注入一个Cookie，内容为随机字符串，然后当用户再次向服务器发送请求的时候，从 cookie 中取出这个字符串，添加到 URL 参数中，然后服务器通过对 cookie 中的数据和参数中的数据进行比较，来进行验证。使用这种方式是利用了攻击者只能利用 cookie，但是不能访问获取 cookie 的特点，但使用这种方法容易遭受XSS攻击.

## 总结

XSS: 相当于用户过分信任网站，放任来自浏览器地址栏代表的那个网站代码在自己本地任意执行，如果没有浏览器的安全机制限制，xss代码可以在用户浏览器为所欲为。

CSRF：相当于网站过分信任用户，放任来自所谓通过访问控制机制的代表合法用户的请求执行网站的某个特定功能。
